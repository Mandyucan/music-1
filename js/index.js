var songList,controlmanager,$=window.Zepto,root=window.player,audio=new root.audioControl;function bindEvent(){$("body").on("play:change",function(o,t,n){audio.getAudio(songList[t].audio),("play"==audio.status||n)&&(audio.play(),root.process.start()),root.render(songList[t]),root.process.renderAllTime(songList[t].duration),root.process.update(0)}),$("body").on("click",".play-btn",function(){"play"==audio.status?(root.process.stop(),audio.pause()):(root.process.start(),audio.play()),$(this).toggleClass("pause")}),$("body").on("click",".list-btn",function(){root.playList.show(controlmanager)}),$("body").on("click",".prev-btn",function(){var o=controlmanager.prev();$("body").trigger("play:change",o)}),$("body").on("click",".next-btn",function(){var o=controlmanager.next();$("body").trigger("play:change",o)})}function bindTouch(){var o=$("body").find(".pro-wrapper").offset(),a=o.left,r=o.width;$("body").find(".slider-pointer").on("touchstart",function(){root.process.stop()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-a)/r;t<0&&(t=0),1<t&&(t=1),root.process.update(t)}).on("touchend",function(o){var t=(o.changedTouches[0].clientX-a)/r;t<0&&(t=0),1<t&&(t=1);var n=t*songList[controlmanager.index].duration;audio.playTo(n),root.process.start(t),$("body").find(".play-btn").addClass("pause")})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){bindEvent(),bindTouch(),root.playList.renderList(o),songList=o,controlmanager=new root.controlManager(o.length),$("body").trigger("play:change",0)},error:function(){}})}getData("./mock/data.json");
